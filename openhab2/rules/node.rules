rule "garage door"
when
    Item Node2Dist changed
then
    if(Node2Dist.state < 1000) {
        postUpdate(garagedoor, OPEN) }
    else{postUpdate(garagedoor, CLOSED) }
end

rule "light level"
when
    Item Node2Light changed
then
    if(Node2Light.state > 300 && garagedoor.state == CLOSED) {
        postUpdate(lightlevel, ON) }
    else{postUpdate(lightlevel, OFF) }
end

rule "garage state"
when
    Item Node4Dist changed
then
    if (Node4Dist.state < 10) {
        postUpdate(garagestate, "Sensor Error")
    } else {
    if (Node4Dist.state >=10 && Node4Dist.state <32) {
        postUpdate(garagestate, "Garage Open")
    } else {
    if (Node4Dist.state >=40 && Node4Dist.state <65) {
        postUpdate(garagestate, "Garage Closed, Occupied")
    } else {
    if (Node4Dist.state >=65 && Node4Dist.state <=140) {
        postUpdate(garagestate, "Garage Closed, Empty")
    } else {
        postUpdate(garagestate, "Sensor Error")
    }}}}
end

rule "garage light"
when
    Item Node4Light changed
then
    if (Node4Light.state > 100 ) {
        postUpdate(garagelight, "Garage Light on")
    } else {
        postUpdate(garagelight, "Garage Light off")
    }
end

rule "node 2 heartbeat update"
when
    Item Node2Heartbeat received update
then
    postUpdate(Node2LastUpdate, new DateTimeType())
end

rule "node 3 heartbeat update"
when
    Item Node3Heartbeat received update
then
    postUpdate(Node3LastUpdate, new DateTimeType())
end

rule "node 4 heartbeat update"
when
    Item Node4Heartbeat received update
then
    postUpdate(Node4LastUpdate, new DateTimeType())
end